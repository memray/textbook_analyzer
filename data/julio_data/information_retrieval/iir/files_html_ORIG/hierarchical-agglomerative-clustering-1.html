<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<html>
 <head> 
  <title>Hierarchical agglomerative clustering</title> 
  <meta name="description" content="Hierarchical agglomerative clustering" /> 
  <meta name="keywords" content="irbook" /> 
  <meta name="resource-type" content="document" /> 
  <meta name="distribution" content="global" /> 
  <meta name="Generator" content="LaTeX2HTML v2002-2-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <link rel="STYLESHEET" href="irbook.css" /> 
  <link rel="next" href="single-link-and-complete-link-clustering-1.html" /> 
  <link rel="previous" href="hierarchical-clustering-1.html" /> 
  <link rel="up" href="hierarchical-clustering-1.html" /> 
  <link rel="next" href="single-link-and-complete-link-clustering-1.html" /> 
 </head> 
 <body> 
  <!--Navigation Panel--> 
  <a name="tex2html4338" href="single-link-and-complete-link-clustering-1.html"> <img width="37" height="24" align="BOTTOM" border="0" alt="next" src="http://nlp.stanford.edu/IR-book/html/icons/next.png" /></a> 
  <a name="tex2html4332" href="hierarchical-clustering-1.html"> <img width="26" height="24" align="BOTTOM" border="0" alt="up" src="http://nlp.stanford.edu/IR-book/html/icons/up.png" /></a> 
  <a name="tex2html4326" href="hierarchical-clustering-1.html"> <img width="63" height="24" align="BOTTOM" border="0" alt="previous" src="http://nlp.stanford.edu/IR-book/html/icons/prev.png" /></a> 
  <a name="tex2html4334" href="contents-1.html"> <img width="65" height="24" align="BOTTOM" border="0" alt="contents" src="http://nlp.stanford.edu/IR-book/html/icons/contents.png" /></a> 
  <a name="tex2html4336" href="index-1.html"> <img width="43" height="24" align="BOTTOM" border="0" alt="index" src="http://nlp.stanford.edu/IR-book/html/icons/index.png" /></a> 
  <br /> 
  <b> Next:</b> 
  <a name="tex2html4339" href="single-link-and-complete-link-clustering-1.html">Single-link and complete-link clustering</a> 
  <b> Up:</b> 
  <a name="tex2html4333" href="hierarchical-clustering-1.html">Hierarchical clustering</a> 
  <b> Previous:</b> 
  <a name="tex2html4327" href="hierarchical-clustering-1.html">Hierarchical clustering</a> &nbsp; 
  <b> <a name="tex2html4335" href="contents-1.html">Contents</a></b> &nbsp; 
  <b> <a name="tex2html4337" href="index-1.html">Index</a></b> 
  <br /> 
  <br /> 
  <!--End of Navigation Panel--> 
  <h1><a name="SECTION002210000000000000000"></a> <a name="sec:hac"></a> <a name="p:hac"></a> <br /> Hierarchical agglomerative clustering </h1> Hierarchical clustering algorithms are either top-down or bottom-up. 
  <a name="27284"></a>Bottom-up algorithms treat each document as a singleton cluster at the outset and then successively merge (or 
  <i>agglomerate</i>) pairs of clusters until all clusters have been merged into a single cluster that contains all documents. Bottom-up hierarchical clustering is therefore called 
  <a name="26381"></a> 
  <i>hierarchical agglomerative clustering</i> or 
  <a name="26383"></a> 
  <i>HAC</i> . Top-down clustering requires a method for splitting a cluster. It proceeds by splitting clusters recursively until individual documents are reached. See Section 
  <a href="divisive-clustering-1.html#sec:divisive">17.6</a> . HAC is more frequently used in IR than top-down clustering and is the main subject of this chapter. 
  <p> </p>
  <div align="CENTER"> 
   <p><a name="fig:rprojectsingle"></a><a name="p:rprojectsingle"></a></p>
   <img width="521" height="555" align="BOTTOM" border="0" src="img1544.png" alt="\includegraphics[width=15cm]{rprojectsingle.eps}" /> A dendrogram of a single-link clustering of 30 documents from Reuters-RCV1. Two possible cuts of the dendrogram are shown: at 0.4 into 24 clusters and at 0.1 into 12 clusters. 
  </div> 
  <p> Before looking at specific similarity measures used in HAC in Sections <a href="single-link-and-complete-link-clustering-1.html#sec:singlecomplete">17.2</a> -<a href="centroid-clustering-1.html#sec:centroidsec">17.4</a> , we first introduce a method for depicting hierarchical clusterings graphically, discuss a few key properties of HACs and present a simple algorithm for computing an HAC. </p>
  <p> An HAC clustering is typically visualized as a <a name="26395"></a> <i>dendrogram</i> as shown in Figure <a href="#fig:rprojectsingle">17.1</a> . Each merge is represented by a horizontal line. The y-coordinate of the horizontal line is the similarity of the two clusters that were merged, where documents are viewed as <a name="26398"></a> singleton clusters. We call this similarity the <a name="p:combsimilarity"></a> <a name="26400"></a> <i>combination similarity</i> of the merged cluster. For example, the combination similarity of the cluster consisting of Lloyd's CEO questioned and Lloyd's chief / U.S. grilling in Figure <a href="#fig:rprojectsingle">17.1</a> is <img width="50" height="32" align="MIDDLE" border="0" src="img1545.png" alt="$\approx
0.56$" />. We define the combination similarity of a singleton cluster as its document's self-similarity (which is 1.0 for cosine similarity). </p>
  <p> By moving up from the bottom layer to the top node, a dendrogram allows us to reconstruct the history of merges that resulted in the depicted clustering. For example, we see that the two documents entitled War hero Colin Powell were merged first in Figure <a href="#fig:rprojectsingle">17.1</a> and that the last merge added Ag trade reform to a cluster consisting of the other 29 documents. </p>
  <p> A fundamental assumption in HAC is that the merge operation is <a name="p:hclstmonotone"></a> <a name="26409"></a> <i>monotonic</i> . Monotonic means that if 
   <!-- MATH
 $s_1,s_2,\ldots,s_{K-1}$
 --> <img width="104" height="32" align="MIDDLE" border="0" src="img1546.png" alt="$s_1,s_2,\ldots,s_{K-1}$" /> are the combination similarities of the successive merges of an HAC, then 
   <!-- MATH
 $s_1 \geq s_2 \geq \ldots \geq
s_{K-1}$
 --> <img width="148" height="32" align="MIDDLE" border="0" src="img1547.png" alt="$s_1 \geq s_2 \geq \ldots \geq
s_{K-1}$" /> holds. A non-monotonic hierarchical clustering contains at least one <a name="26413"></a> <i>inversion</i> <img width="64" height="32" align="MIDDLE" border="0" src="img1548.png" alt="$s_i &lt; s_{i+1}$" /> and contradicts the fundamental assumption that we </p>
  <p> chose the best merge available at each step. We will see an example of an inversion in Figure <a href="centroid-clustering-1.html#fig:inversion">17.12</a> . </p>
  <p> Hierarchical clustering does not require a prespecified number of clusters. However, in some applications we want a partition of disjoint clusters just as in flat clustering. In those cases, the hierarchy needs to be cut at some point. A number of criteria can be used to determine the cutting point: </p>
  <ul> 
   <li>Cut at a prespecified level of similarity. For example, we cut the dendrogram at 0.4 if we want clusters with a minimum combination similarity of 0.4. In Figure <a href="#fig:rprojectsingle">17.1</a> , cutting the diagram at <img width="54" height="32" align="MIDDLE" border="0" src="img1549.png" alt="$y=0.4$" /> yields 24 clusters (grouping only documents with high similarity together) and cutting it at <img width="54" height="32" align="MIDDLE" border="0" src="img1550.png" alt="$y=0.1$" /> yields 12 clusters (one large financial news cluster and 11 smaller clusters). <p> </p></li> 
   <li>Cut the dendrogram where the gap between two successive combination similarities is largest. Such large gaps arguably indicate ``natural'' clusterings. Adding one more cluster decreases the quality of the clustering significantly, so cutting before this steep decrease occurs is desirable. This strategy is analogous to looking for the knee in the <img width="15" height="32" align="MIDDLE" border="0" src="img30.png" alt="$K$" />-means graph in Figure <a href="k-means-1.html#fig:clustercard">16.8</a> (page <a href="k-means-1.html#p:clustercard">16.8</a> ). </li> 
   <li>Apply Equation&nbsp;<a href="cluster-cardinality-in-k-means-1.html#eqn:aicsimple">195</a> (page <a href="cluster-cardinality-in-k-means-1.html#p:aicsimple">16.4.1</a> ): <p></p> 
    <div align="CENTER"> 
     <!-- MATH
 \begin{eqnarray*}
K = \argmin_{K'} [\mbox{RSS}(K') + \lambda K']
\end{eqnarray*}
 --> 
     <img width="197" height="42" border="0" src="img1551.png" alt="\begin{eqnarray*}
K = \argmin_{K'} [\mbox{RSS}(K') + \lambda K']
\end{eqnarray*}" />
    </div> <br clear="ALL" /><p></p> where <img width="19" height="35" align="MIDDLE" border="0" src="img1552.png" alt="$K'$" /> refers to the cut of the hierarchy that results in <img width="19" height="35" align="MIDDLE" border="0" src="img1552.png" alt="$K'$" /> clusters, RSS is the residual sum of squares and <img width="14" height="31" align="MIDDLE" border="0" src="img830.png" alt="$\lambda$" /> is a penalty for each additional cluster. Instead of RSS, another measure of distortion can be used. </li> 
   <li>As in flat clustering, we can also prespecify the number of clusters <img width="15" height="32" align="MIDDLE" border="0" src="img30.png" alt="$K$" /> and select the cutting point that produces <img width="15" height="32" align="MIDDLE" border="0" src="img30.png" alt="$K$" /> clusters. </li> 
  </ul> 
  <p> </p>
  <div align="CENTER">
   <a name="fig:hacalgorithm"></a>
   <a name="p:hacalgorithm"></a>
   <a name="26456"></a> 
   <table> 
    <caption align="BOTTOM">
     <strong>Figure 17.2:</strong> A simple, but inefficient HAC algorithm.
    </caption> 
    <tbody>
     <tr>
      <td><img width="385" height="264" border="0" src="img1553.png" alt="\begin{figure}\begin{algorithm}{SimpleHAC}{d_1,\ldots,d_N}
\begin{FOR}
{n \= 1 \...
...\emph{(deactivate cluster)}
\end{FOR}\\
\RETURN{A}
\end{algorithm}
\end{figure}" /></td>
     </tr> 
    </tbody>
   </table> 
  </div> 
  <p> </p>
  <div align="CENTER"> 
   <p><a name="fig:clustersimilarities"></a><a name="p:clustersimilarities"></a></p>
   <img width="555" height="271" border="0" src="img1554.png" alt="\begin{figure}
% latex2html id marker 26460
\psset{unit=0.7cm}
\begin{pspicture}...
...{}
is a
similarity between two documents from different clusters.}
\end{figure}" /> 
  </div> 
  <p> A simple, naive HAC algorithm is shown in Figure <a href="#fig:hacalgorithm">17.2</a> . We first compute the <img width="51" height="32" align="MIDDLE" border="0" src="img1555.png" alt="$N \times N$" /> similarity matrix <img width="15" height="32" align="MIDDLE" border="0" src="img616.png" alt="$C$" />. The algorithm then executes <img width="45" height="32" align="MIDDLE" border="0" src="img1556.png" alt="$N-1$" /> steps of merging the currently most similar clusters. In each iteration, the two most similar clusters are merged and the rows and columns of the merged cluster <img width="9" height="31" align="MIDDLE" border="0" src="img1557.png" alt="$\oldell$" /> in <img width="15" height="32" align="MIDDLE" border="0" src="img616.png" alt="$C$" /> are updated.<a name="tex2html189" href="footnode.html#foot26482"><sup><img align="BOTTOM" border="1" alt="[*]" src="http://nlp.stanford.edu/IR-book/html/icons/footnote.png" /></sup></a>The clustering is stored as a list of merges in <img width="17" height="32" align="MIDDLE" border="0" src="img167.png" alt="$A$" />. <img width="11" height="32" align="MIDDLE" border="0" src="img1399.png" alt="$I$" /> indicates which clusters are still available to be merged. The function <small>SIM</small><img width="54" height="33" align="MIDDLE" border="0" src="img1558.png" alt="$(\oldell,m,j)$" /> computes the similarity of cluster <img width="9" height="31" align="MIDDLE" border="0" src="img9.png" alt="$j$" /> with the merge of clusters <img width="9" height="31" align="MIDDLE" border="0" src="img1557.png" alt="$\oldell$" /> and <img width="17" height="32" align="MIDDLE" border="0" src="img103.png" alt="$m$" />. For some HAC algorithms, <small>SIM</small><img width="54" height="33" align="MIDDLE" border="0" src="img1558.png" alt="$(\oldell,m,j)$" /> is simply a function of <img width="45" height="33" align="MIDDLE" border="0" src="img1559.png" alt="$C[j][\oldell]$" /> and <img width="53" height="33" align="MIDDLE" border="0" src="img1560.png" alt="$C[j][m]$" />, for example, the maximum of these two values for single-link. </p>
  <p> We will now refine this algorithm for the different similarity measures of single-link and complete-link clustering (Section <a href="single-link-and-complete-link-clustering-1.html#sec:singlecomplete">17.2</a> ) and group-average and centroid clustering ( and <a href="centroid-clustering-1.html#sec:centroidsec">17.4</a> ). The merge criteria of these four variants of HAC are shown in Figure <a href="#fig:clustersimilarities">17.3</a> . </p>
  <p> </p>
  <div align="CENTER"> 
   <p><a name="fig:singlecompletelink"></a><a name="p:singlecompletelink"></a></p>
   <img width="556" height="312" border="0" src="img1561.png" alt="\begin{figure}
% latex2html id marker 26488
\par
\psset{unit=0.75cm}
\par
\begin...
...e-link similarity of the
two left two-point clusters (solid line).}
\end{figure}" /> 
  </div> 
  <p> </p>
  <hr /> 
  <!--Navigation Panel--> 
  <a name="tex2html4338" href="single-link-and-complete-link-clustering-1.html"> <img width="37" height="24" align="BOTTOM" border="0" alt="next" src="http://nlp.stanford.edu/IR-book/html/icons/next.png" /></a> 
  <a name="tex2html4332" href="hierarchical-clustering-1.html"> <img width="26" height="24" align="BOTTOM" border="0" alt="up" src="http://nlp.stanford.edu/IR-book/html/icons/up.png" /></a> 
  <a name="tex2html4326" href="hierarchical-clustering-1.html"> <img width="63" height="24" align="BOTTOM" border="0" alt="previous" src="http://nlp.stanford.edu/IR-book/html/icons/prev.png" /></a> 
  <a name="tex2html4334" href="contents-1.html"> <img width="65" height="24" align="BOTTOM" border="0" alt="contents" src="http://nlp.stanford.edu/IR-book/html/icons/contents.png" /></a> 
  <a name="tex2html4336" href="index-1.html"> <img width="43" height="24" align="BOTTOM" border="0" alt="index" src="http://nlp.stanford.edu/IR-book/html/icons/index.png" /></a> 
  <br /> 
  <b> Next:</b> 
  <a name="tex2html4339" href="single-link-and-complete-link-clustering-1.html">Single-link and complete-link clustering</a> 
  <b> Up:</b> 
  <a name="tex2html4333" href="hierarchical-clustering-1.html">Hierarchical clustering</a> 
  <b> Previous:</b> 
  <a name="tex2html4327" href="hierarchical-clustering-1.html">Hierarchical clustering</a> &nbsp; 
  <b> <a name="tex2html4335" href="contents-1.html">Contents</a></b> &nbsp; 
  <b> <a name="tex2html4337" href="index-1.html">Index</a></b> 
  <!--End of Navigation Panel--> 
  <address> &copy; 2008 Cambridge University Press<br />This is an automatically generated page. In case of formatting errors you may want to look at the <a href="http://informationretrieval.org">PDF edition</a> of the book.<br /> 2009-04-07 </address>   
 </body>
</html>